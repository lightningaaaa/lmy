1、招募时报错
playsingle_controller::recruit //playsingle_controller.cpp:156
    play_controller::do_recruit//play_controller.cpp:4246
        thandler::draw(const bool force)//handler.cpp:578
            dispatcher->fire(DRAW, dynamic_cast<twidget&>(*dispatcher));//handler.cpp:635
                tcontrol::calculate_best_size()//control.cpp:225
                    tpoint maximum = get_config_maximum_size();//control.cpp:234
                    {
                        assert(config_);//control.cpp:195
                        tpoint result(config_->max_width, config_->max_height);
                    }
        # 设置maximum
                    if (!maximum.x) //初始值为0，此if进入
                        maximum.x = settings::screen_width;//此处设置800
        # text的最大宽度设置
                    if (text_maximum_width_ && maximum.x > text_maximum_width_)
                        maximum.x = text_maximum_width_;//此处重新设置为132
                    gui2::tcontrol::get_best_text_size //control.cpp:683
                        font::get_rendered_text_size //font.cpp:694
                            tintegrate::tintegrate//integrate.cpp:290
                                tintegrate::handle_format_cfg(int tag_start, const config &cfg)//librose\integrate.cpp：422
                                    gui2::tcontrol::get_best_text_size //widgets/control.cpp:683
                                        font::get_rendered_text_size //font.cpp:694
                                        {
                                            tintegrate::add_text_item //librose\integrate.cpp：438
                                            {
                                                std::string s = editable_? text: help::remove_first_space(text);
                                                add_text_item(tag_start, start, s, text_color, ref_dst, broken_link, _font_size, bold, italic);//integrate.cpp：480
                                                get_rendered_text//font.cpp:751
                                                {
                                                    VALIDATE(!strchr(text.c_str(), '\n'), null_str);//如果包含\n会奔溃
                                                }
                                            }
                                        }

2、
twindow* window//kingdom-src\kingdom\kingdom\gui\dialogs\recruit.cpp
构造函数中有初始化，有w_

2、
# text的最大宽度设置,原始132
gui2::tcontainer_::layout_children //container.cpp:110
    gui2::tgrid::layout_children //grid.cpp:998
        gui2::tscrollbar_container::layout_children //scrollbar_container.cpp:512
        {   get_size() //librose/gui/widgets/widget.hpp:366
            gui2::tscrollbar_container::place //widgets/scrollbar_container.cpp:260
            {  
                place_content_grid(content_->get_origin(), content_->get_size(), content_grid_origin);//widgets/scrollbar_container.cpp:260
                {//tpoint get_size() const { return tpoint(w_, h_); }//返回的结果-8，不知道为啥
                    gui2::tscroll_label::place_content_grid //widgets/scroll_label.cpp:128
                        tcontrol::set_text_maximum_width(int maximum)//control.cpp:427
                        {
                            text_maximum_width_ = maximum - config_->text_extra_height;
                        }
                }
            }
        }

# 设置w_
twidget::place(const tpoint& origin, const tpoint& size)//widget.cpp:187
{

}

# gdb
Thread 1 "wesnoth" hit Breakpoint 2, gui2::twidget::place (this=0x55555dd39ad8, origin=..., size=...)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/widget.cpp:187
187		if (is_null_rect(fix_rect_)) {
(gdb) p size
$6 = (const gui2::tpoint &) @0x7fffffff8b80: {x = 140, y = 519}
(gdb) bt
#0  gui2::twidget::place (this=0x55555dd39ad8, origin=..., size=...)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/widget.cpp:187
#1  0x00007ffff765cfb5 in gui2::tcontrol::place (this=0x55555dd395a0, origin=..., size=...)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/control.cpp:328
#2  0x00007ffff765881b in gui2::tcontainer_::place (this=0x55555dd395a0, origin=..., size=...)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/container.cpp:40
#3  0x00007ffff769931f in gui2::tscrollbar_container::place (this=0x55555dd395a0, origin=..., size=...)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/scrollbar_container.cpp:253
#4  0x00007ffff769af37 in gui2::tscrollbar_container::layout_children (this=0x55555dd395a0)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/scrollbar_container.cpp:516
#5  0x00007ffff766b27b in gui2::tgrid::layout_children (this=0x5555588f49f0)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/grid.cpp:998
#6  0x00007ffff766b27b in gui2::tgrid::layout_children (this=0x55555ad666f0)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/grid.cpp:998
#7  0x00007ffff7658c32 in gui2::tcontainer_::layout_children (this=0x55555ad66540)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/container.cpp:110
#8  0x00007ffff766b27b in gui2::tgrid::layout_children (this=0x555557668f60)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/grid.cpp:998
#9  0x00007ffff7658c32 in gui2::tcontainer_::layout_children (this=0x555557668db0)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/container.cpp:110
#10 0x00007ffff76ec219 in gui2::twindow::draw (this=0x555557668db0)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/window.cpp:711
#11 0x00007ffff76fa50f in boost::_mfi::mf0<void, gui2::twindow>::operator() (this=0x7fffffff92d8, p=0x555557668db0)
    at /usr/include/boost/bind/mem_fn_template.hpp:49
#12 0x00007ffff76f95bb in boost::_bi::list1<boost::_bi::value<gui2::twindow*> >::operator()<boost::_mfi::mf0<void, gui2::twindow>, boost::_bi::rrlist5<gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int> > (this=0x7fffffff92e8, f=..., a=...)
    at /usr/include/boost/bind/bind.hpp:259
#13 0x00007ffff76f8695 in boost::_bi::bind_t<void, boost::_mfi::mf0<void, gui2::twindow>, boost::_bi::list1<boost::_bi::value<gui2::twindow*> > >::operator()<gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int> (this=0x7fffffff92d8, a1=..., 
    a2=@0x7fffffff913c: gui2::event::DRAW, a3=@0x7fffffff928f: false, a4=@0x7fffffff928e: false, a5=@0x7fffffff9138: 0)
    at /usr/include/boost/bind/bind.hpp:1354
#14 0x00007ffff76f71a3 in boost::detail::function::void_function_obj_invoker5<boost::_bi::bind_t<void, boost::_mfi::mf0<void, gui2::twindow>, boost::_bi::list1<boost::_bi::value<gui2::twindow*> > >, void, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int>::invoke
    (function_obj_ptr=..., a0=..., a1=gui2::event::DRAW, a2=@0x7fffffff928f: false, a3=@0x7fffffff928e: false, a4=0)
    at /usr/include/boost/function/function_template.hpp:159
#15 0x00007ffff759cdcb in boost::function5<void, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int>::operator() (
    this=0x7fffffff92d0, a0=..., a1=gui2::event::DRAW, a2=@0x7fffffff928f: false, a3=@0x7fffffff928e: false, a4=0)
    at /usr/include/boost/function/function_template.hpp:768
--Type <RET> for more, q to quit, c to continue without paging--c
#16 0x00007ffff759c29d in gui2::event::ttrigger::operator()(boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int)>, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&) (this=0x7fffffff9258, functor=..., dispatcher=..., event=gui2::event::DRAW, handled=@0x7fffffff928f: false, halt=@0x7fffffff928e: false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/dispatcher.cpp:142
#17 0x00007ffff759f311 in gui2::event::implementation::fire_event<boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int)>, gui2::event::ttrigger>(gui2::event::tevent, std::vector<std::pair<gui2::twidget*, gui2::event::tevent>, std::allocator<std::pair<gui2::twidget*, gui2::event::tevent> > >&, gui2::twidget*, gui2::twidget*, gui2::event::ttrigger) (event=gui2::event::DRAW, event_chain=std::vector of length 0, capacity 0, dispatcher=0x5555576694d0, widget=0x5555576694d0, functor=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/./gui/auxiliary/event/dispatcher_private.hpp:479
#18 0x00007ffff759d613 in gui2::event::fire_event<boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int)>, gui2::event::ttrigger>(gui2::event::tevent, gui2::twidget*, gui2::twidget*, gui2::event::ttrigger) (event=gui2::event::DRAW, dispatcher=0x5555576694d0, widget=0x5555576694d0, functor=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/./gui/auxiliary/event/dispatcher_private.hpp:559
#19 0x00007ffff759b977 in gui2::event::tdispatcher::fire (this=0x555557669588, event=gui2::event::DRAW, target=..., val=0) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/dispatcher.cpp:187
#20 0x00007ffff75cda77 in gui2::event::thandler::draw (this=0x5555579e3450, force=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/handler.cpp:635
#21 0x00007ffff75ccdf6 in gui2::event::thandler::handle_event (this=0x5555579e3450, event=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/handler.cpp:441
#22 0x00007ffff73cda6a in events::pump () at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/events.cpp:605
#23 0x00007ffff76ebb23 in gui2::twindow::show (this=0x555557668db0, restore=true, auto_close_timeout=0) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/window.cpp:613
#24 0x00007ffff7623279 in gui2::tdialog::show (this=0x7fffffff9a90, video=..., auto_close_time=0) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/dialogs/dialog.cpp:70
#25 0x0000555555d12f79 in play_controller::do_recruit (this=0x7fffffffbe40, city=0x555557588720, cost_exponent=100, rpg_mode=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/play_controller.cpp:4264
#26 0x0000555555d3dd3f in playsingle_controller::recruit (this=0x7fffffffbe40) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playsingle_controller.cpp:156
#27 0x0000555555d44528 in playsingle_controller::execute_command2 (this=0x7fffffffbe40, command=105, sparam="") at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playsingle_controller.cpp:1301
#28 0x00007ffff73bbd92 in display::click_context_menu (this=0x555557263f50, main="ctrl-bar", id="recruit", flags=0) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/display.cpp:1974
#29 0x00007ffff764f2e9 in boost::_mfi::mf3<void, display, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, unsigned long>::operator() (this=0x55555e2ed2b0, p=0x555557263f50, a1="ctrl-bar", a2="recruit", a3=0) at /usr/include/boost/bind/mem_fn_template.hpp:393
#30 0x00007ffff764eb44 in boost::_bi::list4<boost::_bi::value<display*>, boost::_bi::value<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::_bi::value<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::_bi::value<unsigned long> >::operator()<boost::_mfi::mf3<void, display, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, unsigned long>, boost::_bi::rrlist5<gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int> > (this=0x55555e2ed2c0, f=..., a=...) at /usr/include/boost/bind/bind.hpp:463
#31 0x00007ffff764e221 in boost::_bi::bind_t<void, boost::_mfi::mf3<void, display, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, unsigned long>, boost::_bi::list4<boost::_bi::value<display*>, boost::_bi::value<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::_bi::value<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::_bi::value<unsigned long> > >::operator()<gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int> (this=0x55555e2ed2b0, a1=..., a2=@0x7fffffffa05c: gui2::event::LEFT_BUTTON_CLICK, a3=@0x7fffffffa1af: true, a4=@0x7fffffffa1ae: false, a5=@0x7fffffffa058: 0) at /usr/include/boost/bind/bind.hpp:1354
#32 0x00007ffff764d546 in boost::detail::function::void_function_obj_invoker5<boost::_bi::bind_t<void, boost::_mfi::mf3<void, display, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, unsigned long>, boost::_bi::list4<boost::_bi::value<display*>, boost::_bi::value<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::_bi::value<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::_bi::value<unsigned long> > >, void, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int>::invoke (function_obj_ptr=..., a0=..., a1=gui2::event::LEFT_BUTTON_CLICK, a2=@0x7fffffffa1af: true, a3=@0x7fffffffa1ae: false, a4=0) at /usr/include/boost/function/function_template.hpp:159
#33 0x00007ffff759cdcb in boost::function5<void, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int>::operator() (this=0x7fffffffa1f0, a0=..., a1=gui2::event::LEFT_BUTTON_CLICK, a2=@0x7fffffffa1af: true, a3=@0x7fffffffa1ae: false, a4=0) at /usr/include/boost/function/function_template.hpp:768
#34 0x00007ffff759c29d in gui2::event::ttrigger::operator()(boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int)>, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&) (this=0x7fffffffa178, functor=..., dispatcher=..., event=gui2::event::LEFT_BUTTON_CLICK, handled=@0x7fffffffa1af: true, halt=@0x7fffffffa1ae: false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/dispatcher.cpp:142
#35 0x00007ffff759f311 in gui2::event::implementation::fire_event<boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int)>, gui2::event::ttrigger>(gui2::event::tevent, std::vector<std::pair<gui2::twidget*, gui2::event::tevent>, std::allocator<std::pair<gui2::twidget*, gui2::event::tevent> > >&, gui2::twidget*, gui2::twidget*, gui2::event::ttrigger) (event=gui2::event::LEFT_BUTTON_CLICK, event_chain=std::vector of length 0, capacity 0, dispatcher=0x55555955a730, widget=0x5555595c4db8, functor=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/./gui/auxiliary/event/dispatcher_private.hpp:479
#36 0x00007ffff759d613 in gui2::event::fire_event<boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int)>, gui2::event::ttrigger>(gui2::event::tevent, gui2::twidget*, gui2::twidget*, gui2::event::ttrigger) (event=gui2::event::LEFT_BUTTON_CLICK, dispatcher=0x55555955a730, widget=0x5555595c4db8, functor=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/./gui/auxiliary/event/dispatcher_private.hpp:559
#37 0x00007ffff759b977 in gui2::event::tdispatcher::fire (this=0x55555955a7e8, event=gui2::event::LEFT_BUTTON_CLICK, target=..., val=0) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/dispatcher.cpp:187
#38 0x00007ffff75c3423 in gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>::mouse_button_click (this=0x555557239110, drag=0x0, click=0x5555595c4db8) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/distributor.cpp:674
#39 0x00007ffff75bdf6b in gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>::signal_handler_sdl_button_up (this=0x555557239110, event=gui2::event::SDL_LEFT_BUTTON_UP, handled=@0x7fffffffa6cf: false, coordinate=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/distributor.cpp:570
#40 0x00007ffff75cbc91 in boost::_mfi::mf3<void, gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>, gui2::event::tevent, bool&, gui2::tpoint const&>::operator() (this=0x7fffffffa718, p=0x555557239110, a1=gui2::event::SDL_LEFT_BUTTON_UP, a2=@0x7fffffffa6cf: false, a3=...) at /usr/include/boost/bind/mem_fn_template.hpp:393
#41 0x00007ffff75ca985 in boost::_bi::list4<boost::_bi::value<gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>*>, boost::arg<2>, boost::arg<3>, boost::arg<5> >::operator()<boost::_mfi::mf3<void, gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>, gui2::event::tevent, bool&, gui2::tpoint const&>, boost::_bi::rrlist5<gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&> > (this=0x7fffffffa728, f=..., a=...) at /usr/include/boost/bind/bind.hpp:463
#42 0x00007ffff75c900b in boost::_bi::bind_t<void, boost::_mfi::mf3<void, gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>, gui2::event::tevent, bool&, gui2::tpoint const&>, boost::_bi::list4<boost::_bi::value<gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>*>, boost::arg<2>, boost::arg<3>, boost::arg<5> > >::operator()<gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&> (this=0x7fffffffa718, a1=..., a2=@0x7fffffffa55c: gui2::event::SDL_LEFT_BUTTON_UP, a3=@0x7fffffffa6cf: false, a4=@0x7fffffffa6ce: false, a5=...) at /usr/include/boost/bind/bind.hpp:1354
#43 0x00007ffff75c791c in boost::detail::function::void_function_obj_invoker5<boost::_bi::bind_t<void, boost::_mfi::mf3<void, gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>, gui2::event::tevent, bool&, gui2::tpoint const&>, boost::_bi::list4<boost::_bi::value<gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>*>, boost::arg<2>, boost::arg<3>, boost::arg<5> > >, void, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&>::invoke (function_obj_ptr=..., a0=..., a1=gui2::event::SDL_LEFT_BUTTON_UP, a2=@0x7fffffffa6cf: false, a3=@0x7fffffffa6ce: false, a4=...) at /usr/include/boost/function/function_template.hpp:159
#44 0x00007ffff759d6e0 in boost::function5<void, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&>::operator() (this=0x7fffffffa710, a0=..., a1=gui2::event::SDL_LEFT_BUTTON_UP, a2=@0x7fffffffa6cf: false, a3=@0x7fffffffa6ce: false, a4=...) at /usr/include/boost/function/function_template.hpp:768
#45 0x00007ffff759c302 in gui2::event::ttrigger_mouse::operator()(boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&)>, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&) (this=0x7fffffffa678, functor=..., dispatcher=..., event=gui2::event::SDL_LEFT_BUTTON_UP, handled=@0x7fffffffa6cf: false, halt=@0x7fffffffa6ce: false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/dispatcher.cpp:210
#46 0x00007ffff759fc6b in gui2::event::implementation::fire_event<boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&)>, gui2::event::ttrigger_mouse>(gui2::event::tevent, std::vector<std::pair<gui2::twidget*, gui2::event::tevent>, std::allocator<std::pair<gui2::twidget*, gui2::event::tevent> > >&, gui2::twidget*, gui2::twidget*, gui2::event::ttrigger_mouse) (event=gui2::event::SDL_LEFT_BUTTON_UP, event_chain=std::vector of length 0, capacity 0, dispatcher=0x55555955a730, widget=0x55555955a730, functor=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/./gui/auxiliary/event/dispatcher_private.hpp:479
#47 0x00007ffff759d7bc in gui2::event::fire_event<boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&)>, gui2::event::ttrigger_mouse>(gui2::event::tevent, gui2::twidget*, gui2::twidget*, gui2::event::ttrigger_mouse) (event=gui2::event::SDL_LEFT_BUTTON_UP, dispatcher=0x55555955a730, widget=0x55555955a730, functor=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/./gui/auxiliary/event/dispatcher_private.hpp:559
#48 0x00007ffff759ba15 in gui2::event::tdispatcher::fire (this=0x55555955a7e8, event=gui2::event::SDL_LEFT_BUTTON_UP, target=..., coordinate=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/dispatcher.cpp:222
#49 0x00007ffff75cdff3 in gui2::event::thandler::mouse (this=0x5555579e3450, event=gui2::event::SDL_LEFT_BUTTON_UP, position=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/handler.cpp:689
#50 0x00007ffff75ce0f9 in gui2::event::thandler::mouse_button_up (this=0x5555579e3450, position=..., button=1 '\001') at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/handler.cpp:707
#51 0x00007ffff75cca24 in gui2::event::thandler::handle_mouse_up (this=0x5555579e3450, button=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/handler.cpp:369
#52 0x00007ffff73cc5d4 in base_finger::process_event (this=0x5555579e3460, event=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/events.cpp:159
#53 0x00007ffff75ccdbd in gui2::event::thandler::handle_event (this=0x5555579e3450, event=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/handler.cpp:429
#54 0x00007ffff73cda6a in events::pump () at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/events.cpp:605
#55 0x00007ffff73af8e1 in controller_base::play_slice (this=0x7fffffffbe40, is_delay_enabled=true) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/controller_base.cpp:347
#56 0x0000555555d42d3a in playsingle_controller::play_human_turn (this=0x7fffffffbe40) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playsingle_controller.cpp:967
#57 0x0000555555d41001 in playsingle_controller::play_side (this=0x7fffffffbe40) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playsingle_controller.cpp:651
#58 0x0000555555d40ba5 in playsingle_controller::play_turn (this=0x7fffffffbe40, save=true) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playsingle_controller.cpp:591
#59 0x0000555555d3fa3f in playsingle_controller::play_scenario (this=0x7fffffffbe40, story={...}, skip_replay=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playsingle_controller.cpp:457
#60 0x0000555555d32dd1 in playsingle_scenario (game_config=..., level=0x7fffffffc860, disp=..., state_of_game=..., heros=..., heros_start=..., cards=..., story={...}, skip_replay=false, end_level=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playcampaign.cpp:112
#61 0x0000555555d34c99 in play_game (disp=..., gamestate=..., game_config=..., heros=..., heros_start=..., cards=..., io_type=IO_NONE, skip_replay=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playcampaign.cpp:324
#62 0x0000555555bdbc43 in game_instance::launch_game (this=0x55555639d1a0 <create_instance<game_instance>(int, char**)::game>, is_load_game=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/game.cpp:1371
#63 0x0000555555bdd36f in do_gameloop (argc=1, argv=0x7fffffffe218) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/game.cpp:1691
#64 0x0000555555bde031 in main (argc=1, argv=0x7fffffffe218) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/game.cpp:1841


#
content_visible_area_ = {x = 645, y = 35, w = 132, h = 511}

2、
tintegrate::add_text_item
    remaining_width = get_remaining_width();
    {
        get_max_x(curr_loc_.second, curr_row_height_);
        {
# 第二层的原因，SDL_TTF,超过最大宽度，超过最大宽度导致截断
            int text_width = maximum_width_; //最大宽度
        }
    }
    std::vector<std::string> parts = help::split_in_width(text, font_size, remaining_width, state);//librose\integrate.cpp:483
    {split_in_width //help.cpp:228
        SDL_Rect line_size(const std::string& line, int font_size, int style)
        {//b font.cpp:802 if font_size==16 出问题时line="melee(backward)"
            line_size_cache_map& cache = line_size_cache[style][font_size];
# 这里搜索cache
            const line_size_cache_map::const_iterator i = cache.find(line);
            if (i != cache.end()) {
                return i->second;
            }

            SDL_Rect res;

            const SDL_Color col = { 0, 0, 0, 0 };
# 这里初始化
# b font.cpp:810  if strcmp(line,"melee(backward)")==0
            text_surface s(line, font_size, col, style);

            res.w = s.width();
            {
                measure();
                {
                    TTF_SizeUTF8(ttfont, chunk.text.c_str(), &w, &h);
                }
            }
            res.h = s.height();
            res.x = res.y = 0;

# 这里加入cache
# b font.cpp:816 if strcmp(line,"melee(backward)")==0
            cache.insert(std::pair<std::string,SDL_Rect>(line,res));
            return res;
        }
# 报错直接原因，没有push_back
        if (unsplit_width <= width)
			res.push_back(s);
			return res;
    }
    //1: text = "melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n"
    surface surf(font::get_rendered_text(first_part, font_size, color, state));//librose\integrate.cpp:495

2\猜测的maximum_width配置？？？
kingdom-res\data\gui\default\widget\label_background.cfg
    [text]
        x = 0
        y = 0
        w = "(width)"
        h = "(height)"
        maximum_width = "(width)"
        font_size = {FONT_SIZE}
        text_alignment = "(text_alignment)"
        color = {FONT_COLOR_DISABLED}
        text = "(text)"
    [/text]

# gdb
2、
b integrate.cpp:246


2、获取max_width配置？？？应该不是这里
void tcontrol::update_canvas()
{
	const int max_width = get_text_maximum_width();
	const int max_height = get_text_maximum_height();

	// set label in canvases
	BOOST_FOREACH(tcanvas& canvas, canvas_) {
		canvas.set_variable("text", variant(label_));
		canvas.set_variable("text_alignment", variant(encode_text_alignment(text_alignment_)));
		canvas.set_variable("text_maximum_width", variant(max_width));
		canvas.set_variable("text_maximum_height", variant(max_height));
		canvas.set_variable("text_characters_per_line", variant(get_characters_per_line()));
	}
}

3、步兵配置文件
kingdom-src\kingdom\projectfiles\VC\data\core\app-kingdom\units\human\footman1.cfg

# 获取w
size_t text_surface::width() const
{
	if (w_ == -1) {
		if (chunks_.empty()) {
			chunks_ = split_text(str_);
		}
		measure();
	}
	return w_;
}

# 比较完整的调用栈
Thread 1 "wesnoth" hit Breakpoint 7, tintegrate::handle_format_cfg (this=0x7fffffff8420, tag_start=52, cfg=...)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:424
424		const std::string text = cfg["text"];
(gdb) bt
#0  tintegrate::handle_format_cfg (this=0x7fffffff8420, tag_start=52, cfg=...)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:424
#1  0x00007ffff747b0b4 in tintegrate::tintegrate (this=0x7fffffff8420, 
    src="HP: 257\nXP: 259\n<img>src='misc/movement.png'</img>6\n<format>text='兵种' color='green'</format>: 步兵(Lv1)(S)\n<img>src='misc/tintegrate-split-line.png'</img>\n<format>text='能力' color='green'</fo"..., maximum_width=132, maximum_height=-1, 
    default_font_size=16, default_font_color=..., editable=false)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:290
#2  0x00007ffff73e415d in font::get_rendered_text_size (
    text="HP: 257\nXP: 259\n<img>src='misc/movement.png'</img>6\n<format>text='兵种' color='green'</format>: 步兵(Lv1)(S)\n<img>src='misc/tintegrate-split-line.png'</img>\n<format>text='能力' color='green'</fo"..., maximum_width=132, font_size=16, color=..., 
    editable=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/font.cpp:694
#3  0x00007ffff765ec1b in gui2::tcontrol::get_best_text_size (this=0x55555e3e90d0, minimum_size=..., maximum_size=...)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/control.cpp:683
#4  0x00007ffff765c6a2 in gui2::tcontrol::calculate_best_size (this=0x55555e3e90d0)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/control.cpp:250
#5  0x00007ffff76e6d28 in gui2::twidget::get_best_size (this=0x55555e3e9288)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/widget.cpp:176
#6  0x00007ffff766ba7c in gui2::cell_get_best_size (cell=...)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/grid.cpp:1126
#7  0x00007ffff7667da4 in gui2::tgrid::calculate_best_size (this=0x55555b21d8b0)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/grid.cpp:655
#8  0x00007ffff76e6d28 in gui2::twidget::get_best_size (this=0x55555b21d958)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/widget.cpp:176
#9  0x00007ffff768e82f in gui2::tscroll_label::place_content_grid (this=0x55555e3e8970, content_origin=..., content_size=..., 
    desire_origin=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/scroll_label.cpp:128
#10 0x00007ffff769940e in gui2::tscrollbar_container::place (this=0x55555e3e8970, origin=..., size=...)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/scrollbar_container.cpp:260
#11 0x00007ffff769af37 in gui2::tscrollbar_container::layout_children (this=0x55555e3e8970)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/scrollbar_container.cpp:516
#12 0x00007ffff766b27b in gui2::tgrid::layout_children (this=0x55555a859170)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/grid.cpp:998
#13 0x00007ffff766b27b in gui2::tgrid::layout_children (this=0x55555b28a130)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/grid.cpp:998
#14 0x00007ffff7658c32 in gui2::tcontainer_::layout_children (this=0x55555b289f80)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/container.cpp:110
#15 0x00007ffff766b27b in gui2::tgrid::layout_children (this=0x55555e3c6800)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/grid.cpp:998
#16 0x00007ffff7658c32 in gui2::tcontainer_::layout_children (this=0x55555e3c6650)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/container.cpp:110
#17 0x00007ffff76ec219 in gui2::twindow::draw (this=0x55555e3c6650) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/window.cpp:711
#18 0x00007ffff76fa50f in boost::_mfi::mf0<void, gui2::twindow>::operator() (this=0x7fffffff92e8, p=0x55555e3c6650) at /usr/include/boost/bind/mem_fn_template.hpp:49
#19 0x00007ffff76f95bb in boost::_bi::list1<boost::_bi::value<gui2::twindow*> >::operator()<boost::_mfi::mf0<void, gui2::twindow>, boost::_bi::rrlist5<gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int> > (this=0x7fffffff92f8, f=..., a=...) at /usr/include/boost/bind/bind.hpp:259
#20 0x00007ffff76f8695 in boost::_bi::bind_t<void, boost::_mfi::mf0<void, gui2::twindow>, boost::_bi::list1<boost::_bi::value<gui2::twindow*> > >::operator()<gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int> (this=0x7fffffff92e8, a1=..., a2=@0x7fffffff914c: gui2::event::DRAW, a3=@0x7fffffff929f: false, a4=@0x7fffffff929e: false, a5=@0x7fffffff9148: 0) at /usr/include/boost/bind/bind.hpp:1354
#21 0x00007ffff76f71a3 in boost::detail::function::void_function_obj_invoker5<boost::_bi::bind_t<void, boost::_mfi::mf0<void, gui2::twindow>, boost::_bi::list1<boost::_bi::value<gui2::twindow*> > >, void, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int>::invoke (function_obj_ptr=..., a0=..., a1=gui2::event::DRAW, a2=@0x7fffffff929f: false, a3=@0x7fffffff929e: false, a4=0) at /usr/include/boost/function/function_template.hpp:159
#22 0x00007ffff759cdcb in boost::function5<void, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int>::operator() (this=0x7fffffff92e0, a0=..., a1=gui2::event::DRAW, a2=@0x7fffffff929f: false, a3=@0x7fffffff929e: false, a4=0) at /usr/include/boost/function/function_template.hpp:768
#23 0x00007ffff759c29d in gui2::event::ttrigger::operator()(boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int)>, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&) (this=0x7fffffff9268, functor=..., dispatcher=..., event=gui2::event::DRAW, handled=@0x7fffffff929f: false, halt=@0x7fffffff929e: false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/dispatcher.cpp:142
#24 0x00007ffff759f311 in gui2::event::implementation::fire_event<boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int)>, gui2::event::ttrigger>(gui2::event::tevent, std::vector<std::pair<gui2::twidget*, gui2::event::tevent>, std::allocator<std::pair<gui2::twidget*, gui2::event::tevent> > >&, gui2::twidget*, gui2::twidget*, gui2::event::ttrigger) (event=gui2::event::DRAW, event_chain=std::vector of length 0, capacity 0, dispatcher=0x55555e3c6d70, widget=0x55555e3c6d70, functor=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/./gui/auxiliary/event/dispatcher_private.hpp:479
#25 0x00007ffff759d613 in gui2::event::fire_event<boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int)>, gui2::event::ttrigger>(gui2::event::tevent, gui2::twidget*, gui2::twidget*, gui2::event::ttrigger) (event=gui2::event::DRAW, dispatcher=0x55555e3c6d70, widget=0x55555e3c6d70, functor=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/./gui/auxiliary/event/dispatcher_private.hpp:559
#26 0x00007ffff759b977 in gui2::event::tdispatcher::fire (this=0x55555e3c6e28, event=gui2::event::DRAW, target=..., val=0) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/dispatcher.cpp:187
#27 0x00007ffff75cda77 in gui2::event::thandler::draw (this=0x5555579e5160, force=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/handler.cpp:635
#28 0x00007ffff75ccdf6 in gui2::event::thandler::handle_event (this=0x5555579e5160, event=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/handler.cpp:441
#29 0x00007ffff73cda6a in events::pump () at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/events.cpp:605
#30 0x00007ffff76ebb23 in gui2::twindow::show (this=0x55555e3c6650, restore=true, auto_close_timeout=0) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/widgets/window.cpp:613
#31 0x00007ffff7623279 in gui2::tdialog::show (this=0x7fffffff9aa0, video=..., auto_close_time=0) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/dialogs/dialog.cpp:70
#32 0x0000555555d12f79 in play_controller::do_recruit (this=0x7fffffffbe50, city=0x5555571b4a10, cost_exponent=100, rpg_mode=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/play_controller.cpp:4264
#33 0x0000555555d3dd3f in playsingle_controller::recruit (this=0x7fffffffbe50) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playsingle_controller.cpp:156
#34 0x0000555555d44528 in playsingle_controller::execute_command2 (this=0x7fffffffbe50, command=105, sparam="") at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playsingle_controller.cpp:1301
#35 0x00007ffff73bbd92 in display::click_context_menu (this=0x555557abf820, main="ctrl-bar", id="recruit", flags=0) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/display.cpp:1974
#36 0x00007ffff764f2e9 in boost::_mfi::mf3<void, display, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, unsigned long>::operator() (this=0x55555b03a490, p=0x555557abf820, a1="ctrl-bar", a2="recruit", a3=0) at /usr/include/boost/bind/mem_fn_template.hpp:393
#37 0x00007ffff764eb44 in boost::_bi::list4<boost::_bi::value<display*>, boost::_bi::value<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::_bi::value<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::_bi::value<unsigned long> >::operator()<boost::_mfi::mf3<void, display, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, unsigned long>, boost::_bi::rrlist5<gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int> > (this=0x55555b03a4a0, f=..., a=...) at /usr/include/boost/bind/bind.hpp:463
#38 0x00007ffff764e221 in boost::_bi::bind_t<void, boost::_mfi::mf3<void, display, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, unsigned long>, boost::_bi::list4<boost::_bi::value<display*>, boost::_bi::value<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::_bi::value<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::_bi::value<unsigned long> > >::operator()<gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int> (this=0x55555b03a490, a1=..., a2=@0x7fffffffa06c: gui2::event::LEFT_BUTTON_CLICK, a3=@0x7fffffffa1bf: true, a4=@0x7fffffffa1be: false, a5=@0x7fffffffa068: 0) at /usr/include/boost/bind/bind.hpp:1354
#39 0x00007ffff764d546 in boost::detail::function::void_function_obj_invoker5<boost::_bi::bind_t<void, boost::_mfi::mf3<void, display, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, unsigned long>, boost::_bi::list4<boost::_bi::value<display*>, boost::_bi::value<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::_bi::value<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::_bi::value<unsigned long> > >, void, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int>::invoke (function_obj_ptr=..., a0=..., a1=gui2::event::LEFT_BUTTON_CLICK, a2=@0x7fffffffa1bf: true, a3=@0x7fffffffa1be: false, a4=0) at /usr/include/boost/function/function_template.hpp:159
#40 0x00007ffff759cdcb in boost::function5<void, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int>::operator() (this=0x7fffffffa200, a0=..., a1=gui2::event::LEFT_BUTTON_CLICK, a2=@0x7fffffffa1bf: true, a3=@0x7fffffffa1be: false, a4=0) at /usr/include/boost/function/function_template.hpp:768
#41 0x00007ffff759c29d in gui2::event::ttrigger::operator()(boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int)>, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&) (this=0x7fffffffa188, functor=..., dispatcher=..., event=gui2::event::LEFT_BUTTON_CLICK, handled=@0x7fffffffa1bf: true, halt=@0x7fffffffa1be: false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/dispatcher.cpp:142
#42 0x00007ffff759f311 in gui2::event::implementation::fire_event<boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int)>, gui2::event::ttrigger>(gui2::event::tevent, std::vector<std::pair<gui2::twidget*, gui2::event::tevent>, std::allocator<std::pair<gui2::twidget*, gui2::event::tevent> > >&, gui2::twidget*, gui2::twidget*, gui2::event::ttrigger) (event=gui2::event::LEFT_BUTTON_CLICK, event_chain=std::vector of length 0, capacity 0, dispatcher=0x555559583e30, widget=0x5555595ede28, functor=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/./gui/auxiliary/event/dispatcher_private.hpp:479
#43 0x00007ffff759d613 in gui2::event::fire_event<boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, int)>, gui2::event::ttrigger>(gui2::event::tevent, gui2::twidget*, gui2::twidget*, gui2::event::ttrigger) (event=gui2::event::LEFT_BUTTON_CLICK, dispatcher=0x555559583e30, widget=0x5555595ede28, functor=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/./gui/auxiliary/event/dispatcher_private.hpp:559
#44 0x00007ffff759b977 in gui2::event::tdispatcher::fire (this=0x555559583ee8, event=gui2::event::LEFT_BUTTON_CLICK, target=..., val=0) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/dispatcher.cpp:187
#45 0x00007ffff75c3423 in gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>::mouse_button_click (this=0x555556f91c30, drag=0x0, click=0x5555595ede28) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/distributor.cpp:674
#46 0x00007ffff75bdf6b in gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>::signal_handler_sdl_button_up (this=0x555556f91c30, event=gui2::event::SDL_LEFT_BUTTON_UP, handled=@0x7fffffffa6df: false, coordinate=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/distributor.cpp:570
#47 0x00007ffff75cbc91 in boost::_mfi::mf3<void, gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>, gui2::event::tevent, bool&, gui2::tpoint const&>::operator() (this=0x7fffffffa728, p=0x555556f91c30, a1=gui2::event::SDL_LEFT_BUTTON_UP, a2=@0x7fffffffa6df: false, a3=...) at /usr/include/boost/bind/mem_fn_template.hpp:393
#48 0x00007ffff75ca985 in boost::_bi::list4<boost::_bi::value<gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>*>, boost::arg<2>, boost::arg<3>, boost::arg<5> >::operator()<boost::_mfi::mf3<void, gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>, gui2::event::tevent, bool&, gui2::tpoint const&>, boost::_bi::rrlist5<gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&> > (this=0x7fffffffa738, f=..., a=...) at /usr/include/boost/bind/bind.hpp:463
#49 0x00007ffff75c900b in boost::_bi::bind_t<void, boost::_mfi::mf3<void, gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>, gui2::event::tevent, bool&, gui2::tpoint const&>, boost::_bi::list4<boost::_bi::value<gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>*>, boost::arg<2>, boost::arg<3>, boost::arg<5> > >::operator()<gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&> (this=0x7fffffffa728, a1=..., a2=@0x7fffffffa56c: gui2::event::SDL_LEFT_BUTTON_UP, a3=@0x7fffffffa6df: false, a4=@0x7fffffffa6de: false, a5=...) at /usr/include/boost/bind/bind.hpp:1354
#50 0x00007ffff75c791c in boost::detail::function::void_function_obj_invoker5<boost::_bi::bind_t<void, boost::_mfi::mf3<void, gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>, gui2::event::tevent, bool&, gui2::tpoint const&>, boost::_bi::list4<boost::_bi::value<gui2::event::tmouse_button<(gui2::event::tevent)7, (gui2::event::tevent)8, (gui2::event::tevent)9, (gui2::event::tevent)10, (gui2::event::tevent)11, (gui2::event::tevent)12>*>, boost::arg<2>, boost::arg<3>, boost::arg<5> > >, void, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&>::invoke (function_obj_ptr=..., a0=..., a1=gui2::event::SDL_LEFT_BUTTON_UP, a2=@0x7fffffffa6df: false, a3=@0x7fffffffa6de: false, a4=...) at /usr/include/boost/function/function_template.hpp:159
#51 0x00007ffff759d6e0 in boost::function5<void, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&>::operator() (this=0x7fffffffa720, a0=..., a1=gui2::event::SDL_LEFT_BUTTON_UP, a2=@0x7fffffffa6df: false, a3=@0x7fffffffa6de: false, a4=...) at /usr/include/boost/function/function_template.hpp:768
#52 0x00007ffff759c302 in gui2::event::ttrigger_mouse::operator()(boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&)>, gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&) (this=0x7fffffffa688, functor=..., dispatcher=..., event=gui2::event::SDL_LEFT_BUTTON_UP, handled=@0x7fffffffa6df: false, halt=@0x7fffffffa6de: false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/dispatcher.cpp:210
#53 0x00007ffff759fc6b in gui2::event::implementation::fire_event<boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&)>, gui2::event::ttrigger_mouse>(gui2::event::tevent, std::vector<std::pair<gui2::twidget*, gui2::event::tevent>, std::allocator<std::pair<gui2::twidget*, gui2::event::tevent> > >&, gui2::twidget*, gui2::twidget*, gui2::event::ttrigger_mouse) (event=gui2::event::SDL_LEFT_BUTTON_UP, event_chain=std::vector of length 0, capacity 0, dispatcher=0x555559583e30, widget=0x555559583e30, functor=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/./gui/auxiliary/event/dispatcher_private.hpp:479
#54 0x00007ffff759d7bc in gui2::event::fire_event<boost::function<void (gui2::event::tdispatcher&, gui2::event::tevent, bool&, bool&, gui2::tpoint const&)>, gui2::event::ttrigger_mouse>(gui2::event::tevent, gui2::twidget*, gui2::twidget*, gui2::event::ttrigger_mouse) (event=gui2::event::SDL_LEFT_BUTTON_UP, dispatcher=0x555559583e30, widget=0x555559583e30, functor=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/./gui/auxiliary/event/dispatcher_private.hpp:559
#55 0x00007ffff759ba15 in gui2::event::tdispatcher::fire (this=0x555559583ee8, event=gui2::event::SDL_LEFT_BUTTON_UP, target=..., coordinate=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/dispatcher.cpp:222
#56 0x00007ffff75cdff3 in gui2::event::thandler::mouse (this=0x5555579e5160, event=gui2::event::SDL_LEFT_BUTTON_UP, position=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/handler.cpp:689
#57 0x00007ffff75ce0f9 in gui2::event::thandler::mouse_button_up (this=0x5555579e5160, position=..., button=1 '\001') at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/handler.cpp:707
#58 0x00007ffff75cca24 in gui2::event::thandler::handle_mouse_up (this=0x5555579e5160, button=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/handler.cpp:369
#59 0x00007ffff73cc5d4 in base_finger::process_event (this=0x5555579e5170, event=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/events.cpp:159
#60 0x00007ffff75ccdbd in gui2::event::thandler::handle_event (this=0x5555579e5160, event=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/gui/auxiliary/event/handler.cpp:429
#61 0x00007ffff73cda6a in events::pump () at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/events.cpp:605
#62 0x00007ffff73af8e1 in controller_base::play_slice (this=0x7fffffffbe50, is_delay_enabled=true) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/controller_base.cpp:347
#63 0x0000555555d42d3a in playsingle_controller::play_human_turn (this=0x7fffffffbe50) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playsingle_controller.cpp:967
#64 0x0000555555d41001 in playsingle_controller::play_side (this=0x7fffffffbe50) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playsingle_controller.cpp:651
#65 0x0000555555d40ba5 in playsingle_controller::play_turn (this=0x7fffffffbe50, save=true) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playsingle_controller.cpp:591
#66 0x0000555555d3fa3f in playsingle_controller::play_scenario (this=0x7fffffffbe50, story={...}, skip_replay=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playsingle_controller.cpp:457
#67 0x0000555555d32dd1 in playsingle_scenario (game_config=..., level=0x7fffffffc870, disp=..., state_of_game=..., heros=..., heros_start=..., cards=..., story={...}, skip_replay=false, end_level=...) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playcampaign.cpp:112
#68 0x0000555555d34c99 in play_game (disp=..., gamestate=..., game_config=..., heros=..., heros_start=..., cards=..., io_type=IO_NONE, skip_replay=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/playcampaign.cpp:324
#69 0x0000555555bdbc43 in game_instance::launch_game (this=0x55555639d1a0 <create_instance<game_instance>(int, char**)::game>, is_load_game=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/game.cpp:1371
#70 0x0000555555bdd36f in do_gameloop (argc=1, argv=0x7fffffffe228) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/game.cpp:1691
#71 0x0000555555bde031 in main (argc=1, argv=0x7fffffffe228) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/kingdom/game.cpp:1841
(gdb) 


# 清除cache的调用栈
static void clear_fonts()
{
	for(std::map<font_id,TTF_Font*>::iterator i = font_table.begin(); i != font_table.end(); ++i) {
		TTF_CloseFont(i->second);
	}

	font_table.clear();
	font_names.clear();
	char_blocks.cbmap.clear();
	line_size_cache.clear(); // font.cpp:294
}

# 加入cache的调用栈
(gdb) bt
#0  font::line_size (line="melee(backward)", font_size=16, style=0)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/font.cpp:816
#1  0x00007ffff74f1d46 in font::word_wrap_text (unwrapped_text="  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", 
    font_sz=16, max_width=134, max_height=-1, max_lines=1, partial_line=true)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/marked-up_text.cpp:285
#2  0x00007ffff743835c in help::split_in_width (s="  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", font_size=16, 
    width=134, style=0) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/help.cpp:251
#3  0x00007ffff747dbfb in tintegrate::add_text_item (this=0x7fffffff8410, tag_start=394, start=394, 
    text="  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., ref_dst="", broken_link=false, _font_size=-1, 
    bold=false, italic=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:483
#4  0x00007ffff747da28 in tintegrate::add_text_item (this=0x7fffffff8410, tag_start=394, start=394, 
    text="\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., ref_dst="", broken_link=false, 
    _font_size=-1, bold=false, italic=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:466
#5  0x00007ffff747e0a2 in tintegrate::add_text_item (this=0x7fffffff8410, tag_start=394, start=394, 
    text="sword2 (blade)\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., ref_dst="", 
    broken_link=false, _font_size=-1, bold=false, italic=false)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:530
#6  0x00007ffff747da28 in tintegrate::add_text_item (this=0x7fffffff8410, tag_start=394, start=394, 
    text="\nsword2 (blade)\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., ref_dst="", 
    broken_link=false, _font_size=-1, bold=false, italic=false)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:466
#7  0x00007ffff747e0a2 in tintegrate::add_text_item (this=0x7fffffff8410, tag_start=394, start=394, 
    text="melee(sweep)\nsword2 (blade)\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., ref_dst="", 
    broken_link=false, _font_size=-1, bold=false, italic=false)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:530
#8  0x00007ffff747dbc1 in tintegrate::add_text_item (this=0x7fffffff8410, tag_start=394, start=394, 
    text="melee(sweep)\nsword2 (blade)\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., ref_dst="", 
    broken_link=false, _font_size=-1, bold=false, italic=false)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:480
#9  0x00007ffff747e0a2 in tintegrate::add_text_item (this=0x7fffffff8410, tag_start=394, start=394, 
    text="  10-3 - melee(sweep)\nsword2 (blade)\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., 
    ref_dst="", broken_link=false, _font_size=-1, bold=false, italic=false)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:530
#10 0x00007ffff747da28 in tintegrate::add_text_item (this=0x7fffffff8410, tag_start=394, start=394, 
    text="\n  10-3 - melee(sweep)\nsword2 (blade)\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., 
    ref_dst="", broken_link=false, _font_size=-1, bold=false, italic=false)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:466



# gdb查看
（1）招募弓箭手
1: text = "short sword (blade)\n  1-1 - melee\nbow (archery)\n  9-3 - ranged(verticalattack)\n\n"
（2）招募步兵--失败
1: text = "sword (blade)\n  10-3 - melee(sweep)\nsword2 (blade)\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n"

# 调用栈1
3、奔溃时调用栈
Thread 1 "wesnoth" hit Breakpoint 1, font::get_rendered_text (
    text="sword2 (blade)", font_size=16, color=..., style=0)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/font.cpp:760
760		VALIDATE(!strchr(text.c_str(), '\n'), null_str);
(gdb) c
Continuing.

Thread 1 "wesnoth" hit Breakpoint 1, font::get_rendered_text (
    text="  10-3 - ", font_size=16, color=..., style=0)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/font.cpp:760
760		VALIDATE(!strchr(text.c_str(), '\n'), null_str);
(gdb) c
Continuing.

Thread 1 "wesnoth" hit Breakpoint 1, font::get_rendered_text (
    text="melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", 
    font_size=16, color=..., style=0)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/font.cpp:760
760		VALIDATE(!strchr(text.c_str(), '\n'), null_str);
(gdb) bt
#0  font::get_rendered_text (
    text="melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", 
    font_size=16, color=..., style=0)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/font.cpp:760
#1  0x00007ffff747dc92 in tintegrate::add_text_item (this=0x7fffffff8420, 
    tag_start=394, start=394, 
    text="melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", 
    text_color=..., ref_dst="", broken_link=false, _font_size=-1, bold=false, 
    italic=false)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:495
#2  0x00007ffff747dbc1 in tintegrate::add_text_item (this=0x7fffffff8420, 
    tag_start=394, start=394, 
    text="melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", 
    text_color=..., ref_dst="", broken_link=false, _font_size=-1, bold=false, 
    italic=false)
    at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:480
#3  0x00007ffff747e0a2 in tintegrate::add_text_item (this=0x7fffffff8420, 
    tag_start=394, start=394, 
    text="  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", 
    text_color=..., ref_dst="", broken_link=false, _font_size=-1, bold=false, 
    italic=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:530
#4  0x00007ffff747da28 in tintegrate::add_text_item (this=0x7fffffff8420, tag_start=394, start=394, text="\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., ref_dst="", broken_link=false, _font_size=-1, bold=false, italic=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:466
#5  0x00007ffff747e0a2 in tintegrate::add_text_item (this=0x7fffffff8420, tag_start=394, start=394, text="sword2 (blade)\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., ref_dst="", broken_link=false, _font_size=-1, bold=false, italic=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:530
#6  0x00007ffff747da28 in tintegrate::add_text_item (this=0x7fffffff8420, tag_start=394, start=394, text="\nsword2 (blade)\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., ref_dst="", broken_link=false, _font_size=-1, bold=false, italic=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:466
#7  0x00007ffff747e0a2 in tintegrate::add_text_item (this=0x7fffffff8420, tag_start=394, start=394, text="melee(sweep)\nsword2 (blade)\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., ref_dst="", broken_link=false, _font_size=-1, bold=false, italic=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:530
#8  0x00007ffff747dbc1 in tintegrate::add_text_item (this=0x7fffffff8420, tag_start=394, start=394, text="melee(sweep)\nsword2 (blade)\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., ref_dst="", broken_link=false, _font_size=-1, bold=false, italic=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:480
#9  0x00007ffff747e0a2 in tintegrate::add_text_item (this=0x7fffffff8420, tag_start=394, start=394, text="  10-3 - melee(sweep)\nsword2 (blade)\n  10-3 - melee(backward)\ncrossbow (archery)\n  1-1 - ranged\n\n", text_color=..., ref_dst="", broken_link=false, _font_size=-1, bold=false, italic=false) at /mnt/hgfs/MyCode_ShareVm/war_of_kingdom_linux/kingdom-src/kingdom/librose/integrate.cpp:530

